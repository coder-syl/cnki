if(typeof ISIE=="undefined"){ISIE=navigator.userAgent.indexOf("MSIE")!=-1&&!window.opera}if(typeof sugPara!="Object"){sugPara={IsTopK:false,IsExp:false,Expara:{CSYDPicS:"http://192.168.100.131"},IsAttr:false,AttrCallFun:function(f){try{var b=$(f).find("input[name='codevalue']").val();var a=$(f).find("b").text();if(b){categoryClick(b,a);return false}}catch(d){}},attrSet:function(f){try{var b=$(f).find("input[name='codevalue']").val();var a=$(f).find("b").text();if(ge("hiddenNavi")){ge("hiddenNavi").innerHTML=SpecilNavi(b,a)}}catch(d){}},searchClick:function(){try{$("#btnSearch").click()}catch(a){}},getHistoryWords:function(){var b="UserInputs";var f=function(h){var k="";if(window.localStorage){k=localStorage.getItem(h)}else{var i,j=new RegExp("(^| )"+h+"=([^;]*)(;|$)");if(i=document.cookie.match(j)){k=unescape(i[2])}}if(k==null){k=""}return k};var d=f(b);if(d){var g=d.split("|");var a=g.length;var c=new Array();for(var e=0;e<a;e++){if(g[e]==null||g[e]==""){continue}c.push(g[e])}return c}return[]},clearHistory:function(b,d){var c=function(g){var h=g+"=";if(document.cookie.length>0){offset=document.cookie.indexOf(h);if(offset!=-1){offset+=h.length;end=document.cookie.indexOf(";",offset);if(end==-1){end=document.cookie.length}return unescape(document.cookie.substring(offset,end))}}};if(window.localStorage){localStorage.removeItem("UserInputs")}else{var a=new Date();a.setTime(a.getTime()-1);var e=c("UserInputs");if(e!=null){document.cookie="UserInputs=| ;expires="+a.toGMTString()+";path=/"}}$("#newsearchhis").html("");$("#history_js").hide();$("#newsearchhis").hide();if(typeof CoreDomainLoadJson=="function"){var f=new CoreDomainLoadJson();f.Load("../request/GetUserInputsHandler.ashx?action=UserInputs",function(){},"AyclearHistoryScrpitO")}}}}function J(a){return document.createElement(a)}function createdroplist(){var a=document.getElementById("__droplist");if(a){document.body.removeChild(a)}a=J("div");a.id="__droplist";a.name="__droplist";if(a.className!="undefined"){a.className="dictdiv"}a.setAttribute("class","dictdiv");document.body.appendChild(a)}function InitSug(b){createdroplist();CircleQueue(20);var a="input[id^=searchinput]";if(Object.prototype.toString.call(b)!="[object String]"){b=""}BindDroplist(a,b,sugPara)}function BindDroplist(V,o,W){if(o==undefined){return}sugUrlComm.Server=o;var K=function(ag){var ah=document.getElementById("expandarea");if(ah){ag=ag||window.event;var O=ag.srcElement||ag.target;while(O){if(O==ah){return true}O=O.parentNode}}};var g=$("#__droplist"),a="",y="",t=null,z="",H="",B="",ac="",T=-1,G=0,f="",c=W.IsTopK||false,ae=W.IsAttr||false,X=W.AttrCallFun||function(){},C=W.attrSet||function(){},E=W.IsExp||false,l=W.getHistoryWords||function(){return[]},m=function(){if(W.clearHistory){W.clearHistory()}g.empty()},L=false,s="180px",j=0;$(document.body).bind("click",function(O){if(K(O)){return}g.css("display","none")});function n(ag,O,ah){if(ag){return ag.addEventListener?ag.addEventListener(O,ah,false):ag.attachEvent("on"+O,ah)}}function q(ah){B=$(this).attr("id");t=$("#"+B);var ag=t.val();ag=ag.replace(/(^\s*)|(\s*$)/g,"");if(ag==""&&j!=1){g.hide();return}P();Q();var O=(ah.keyCode)||(ah.which)||(ah.charCode);if(!(O==40||O==38||O==13||O==9||O==27)){if(ag==z&&H==a){p(ag);return}}if((O==37||O==39)&&B==ac&&H==a){p(ag);return}if(O==9||O==40||O==38){var ai=false;if(O==9||O==40){ai=true}if(O==9){i(ah)}U(ai)}else{if(O==13){if(typeof firstTag!="undefined"&&firstTag==true){g.hide();firstTag=false}else{if(T!=-1){M();g.hide();T=-1}else{if(ag!=z||B!=ac||H!=a){w()}else{g.hide()}}}}else{if(O==27){g.hide()}else{w()}}}H=a;z=ag}function r(ag){ag=ag||function(){};if(typeof top_Words_Json=="undefined"){var O=new Z();O.Load(sugUrlComm.getTopUrl(o),ag,"TopWords_Request")}ag()}if(c){r(function(){});$(V).live("click",D)}$(V).live("keyup",q);function D(ag){t=ag.srcElement||ag.target;t=$(t);B=t.attr("id");var O=t.val();O=O.replace(/(^\s*)|(\s*$)/g,"");if(!O){g.empty();G=0;v(ag);d(ag);x().mousedown(function(ah){aa(this,ah)});A();T=-1}}function v(ag){var O=l();if(O&&O.length>0){j=0;new Array().slice;var ah=h.getTitleTipHtml(O.length>3?O.slice(0,3):O,"",u(),"");if(ah){if($("#sugtip_ULlist").length<=0){g.append(h.getTipIframe())}$("#sugtip_ULlist").append(ah+'<div class="topRecom" style="line-height:18px;padding-bottom:3px;padding-left:28px;border-bottom:1px solid #ddd;"><a id="clearHistoryO">清除检索历史</a></div>');$("#clearHistoryO").mousedown(function(ai){m()})}}}function u(){var O=t.val().replace("\\","").replace(/(^\s*)|(\s*$)/g,"");O=O.toLowerCase();return O}function d(O){r(function(){j=1;var ag="";if(typeof top_Words_Json=="undefined"){return}if(Object.prototype.toString.call(top_Words_Json)=="[object Array]"){ag=top_Words_Json.join(";")}else{if(typeof top_Words_Json!="undefined"){if(top_Words_Json.Count!="0"){ag=top_Words_Json.sug}}}if(!ag){return}ag=F(ag);var ah=h.getTitleTipHtml(ag,"",u(),"今日热词");if(ah){if($("#sugtip_ULlist").length<=0){g.append(h.getTipIframe())}$("#sugtip_ULlist").append(ah)}if(document.activeElement.id==B){e()}})}function i(O){if(O.preventDefault){O.preventDefault()}O.cancelBubble=true;return O.returnValue=false}function p(O){A();g.show();H=a;z=O}function S(O,ag,ah){if(ISIE){if(ag=="load"){O.onreadystatechange=function(){if(this.readyState=="loaded"){ah()}}}else{O.attachEvent("on"+ag,(function(ai){return function(){ah.call(ai)}})(O))}}else{O.addEventListener(ag,ah,false)}}function Z(){this.C;this.J=J;this.O=S;this.Load=function(ai,O,ag){var ah=document.getElementById(ag);if(ah){document.body.removeChild(ah)}this.C=J("SCRIPT");this.C.type="text/javascript";if(typeof ag=="string"&&ag.length>0){this.C.id=ag}else{this.C.id="callScriptE"}this.C.src=ai+"&td="+(new Date()).getTime();this.C.charset="utf-8";document.body.appendChild(this.C);S(this.C,"load",O)}}function Q(){var O=getQueryString("sfield");if(O){O=O.toLowerCase();if(O=="au"){a="作者"}if(O=="in"){a="单位"}if(O=="fu"){a="基金"}}else{a=""}}function P(){y=$("#singleDB").val();if(!y){y=$("#dbPrefix").val()}}function Y(){if(B.indexOf("magazine_")==0){return"source"}if(B.indexOf("base")==0){return"base"}return""}function w(){ac=B;var ag=$("#"+B).val().replace(/(^\s*)|(\s*$)/g,"");if(ag==""){g.hide();return}ag=ag.replace(/\s+/g," ");var ah=ag.lastIndexOf(" ");var aj="";f=ag;if(ah>0){aj=ag.substring(0,ah+1);ag=ag.substring(ah+1,ag.length)}A();T=-1;j=0;g.empty();var ai=sugUrlComm.getURL(o,a,ag,(y?"&dbt="+y:"")+(!ae||ah>0?"":"&attr=1"));var O=new Z();O.Load(ai,function(){var ak="";var an="";if(typeof oJson!="undefined"){if(oJson&&Object.prototype.toString.call(oJson)=="[object Array]"){ak=oJson.join(";")}else{if(oJson.Count!="0"){try{ak=oJson.sug;an=oJson.attr}catch(am){}}}}if(ak!=null&&ak!=""&&$("#"+B).val().replace(/(^\s*)|(\s*$)/g,"")!=""){g.empty();var al=h.createlist(ak,aj,u(),an);if(al){g.append(al)}x().mousedown(function(ao){aa(this,ao)});if(document.activeElement.id==B){e()}}else{g.hide()}},"sugkewword_JS")}function e(){g.show();if(L){var ag=$("#tipWordList");if(ag.length<=0){ag=$("#sugtip_ULlist ul").first()}var ah=ag.height();var O=0;$("#expandarea .dictmore").each(function(){O+=$(this).height()});if(O+20>ah){ag.height(O+20)}else{$("#expandarea .dictmore").height(ah-20)}}else{af()}}function R(ag,O){if(ag&&O){var ah=new RegExp("^"+O,"i");return ag.replace(ah,"")}return ag}function N(ah,O){var ag=ah;if(O&&ah.indexOf(O)==0){ag=O+"<strong>"+F(ah.substr(O.length))+"</strong>"}return ag}var h=(function(ai){this.CreateContentEle=function(am,ap,ao,aq,an){var ar="<"+am+" "+(ap?"id='"+ap+"'":"")+(ao?" class='"+ao+"'":"")+(an?an:"")+">";ar+=aq;ar+="</"+am+">";return ar};function ah(an,ar){var ao=an.toLowerCase().split(";");var am="";var ap=t.val().replace("\\","").replace(/(^\s*)|(\s*$)/g,"");ap=ap.toLowerCase();for(var aq=0;aq<ao.length;aq++){if(ao[aq]==null||ao[aq]==""){continue}am+=O(ao[aq],ap,G,ar);G++}return am}function O(at,an,ao,aq){var aw="";var ar=aq+aj(at);var am=RegExp("^"+an,"ig");var ax=al(N(ar,an),ao);var av=false;if(E){if(I(ar)){ax=F(ax)+"<i></i>";av=true}}var au="try {ge('btnSearch').click();} catch (e) {};";if(B.indexOf("buttom_")>=0||B.indexOf("sen_")>=0){au=""}var ap=R(ar,aq);aw="<div "+ag(av,ar,ap)+ak(av)+" onmousedown=\"$('#'+'"+B+"').val('"+b(F(ar))+"');"+au+"\"><span class='rw' id='rw"+ao.toString()+"'>"+ax+"</span></div>";return aw}function al(an,am){if(j==1){switch(am){case 0:return"<em class='num num1'>1</em>"+an;case 1:return"<em class='num num2'>2</em>"+an;case 2:return"<em class='num num3'>3</em>"+an}return"<em class='num'>"+(am+1).toString()+"</em>"+an}else{if(j==2){return"<em class='num numx'></em>"+an}}return an}function aj(am){var an="";if(SugExpand.MarkRegex.test(am)){an=am.match(SugExpand.MarkRegex)[0];am=F(am)}am=am.split(",")[0]+an;return am}function ag(ao,an,am){return' onmouseover="return tipDivOnMouseOverEvent(this,'+ao.toString()+",'"+an+"','"+am+"',event);\""}function ak(am){return' onmouseout="tipDivOnMouseOutEvent(this,'+am.toString()+',event);"';eventHtml+=' return false; "';return eventHtml}this.CreateDiv=function(an,am,ao){return CreateContentEle("div",an,am,ao)};this.CreateUL=function(an,am,ao){return CreateContentEle("ul",an,am,ao)};this.CreateLI=function(ao,an,ap,am){return CreateContentEle("li",ao,an,ap,am)};this.createListLi=function(at,an,ao,aq,am){var av="";var ar=aq+aj(at);var aw=al(N(ar,an),am);var au=false;if(E){if(I(ar)){aw=F(aw)+"<i></i>";au=true}}else{aw=F(aw)}var ap=R(ar,aq);av=CreateLI("rw"+ao.toString(),"rw",aw,this.getLiEvent(au,ar,ap,B));return av};this.getLiEvent=function(ap,am,ao,an){return getLiMouseEvent(ap,am,ao,an,"")};this.getLiMouseEvent=function(ap,am,ao,an,aq){return ag(ap,am,ao)+ak(ap)};return{createlist:function(an,ar,am,ao,ap){G=0;var aq=CreateDiv("sugtip_list","dictlistX",this.getWordsC(an,ar,am,ao,ap));return aq},splitRemoveEmptyEntries:function(an){var aq=an.toLowerCase().split(";");var am=aq.length;var ap=new Array();for(var ao=0;ao<am;ao++){if(aq[ao]==null||aq[ao]==""){continue}ap.push(aq[ao])}return ap},getAttrC:function(ao,au,ay){var aw="";var ap="";if(ao&&au){var av=aj(F(ao));var az=N(av,ay);ap+=CreateLI("rw"+G.toString(),"rw1",az,getLiEvent(false,av,ar,B));var ar=R(av,"");var am=au.split("$$");var at=am[0].split(";");var aq=am[1].split(";");var an='<input type="hidden" name="inputvalue" value="'+F(ao)+'"/>';if(at.length==aq.length){for(var ax=0;ax<at.length;ax++){if(aq[ax]){G++;ap+=CreateLI("rw"+G.toString(),"rw2","在<b>"+aq[ax]+"</b>分类中检索"+an+'<input type="hidden" name="codevalue" value="'+at[ax]+'"/>',getLiMouseEvent(false,av,ar,B))}}}G++}if(ap){aw+=CreateDiv("Attr_Div","dictlistTop",CreateUL("","l",ap))}return aw},getTipWHtml:function(aq,ap,am){var ar=ap;if(Object.prototype.toString.call(ap)=="[object String]"){ar=this.splitRemoveEmptyEntries(ap)}var an="";for(var ao=0;ao<ar.length;ao++){an+=createListLi(ar[ao],aq,G,am,ao);G++}return an},getWordsC:function(au,ao,ar,av,ap){var am=this.splitRemoveEmptyEntries(au);var aq="";var at="";if(ap){at='<div class="topRecom" >'+ap+"</div>"}var an="";if(av){an=this.getAttrC(am[0],av,ar)}aq=this.getTipWHtml(ar,am,ao);return an+CreateDiv("sugtip_ULlist","dictlistCol clearfix",at+CreateUL("","",aq))},getTipIframe:function(){return CreateDiv("sugtip_list","dictlistX",CreateDiv("sugtip_ULlist","dictlistCol clearfix",""))},getTitleTipHtml:function(ar,ao,ap,aq){var an="";var am="";if(aq){am='<div class="topRecom" >'+aq+"</div>"}an=this.getTipWHtml(ap,ar,ao);return am+CreateUL("","",an)}}})(jQuery);function x(){return $("#Attr_Div li,#sugtip_ULlist > UL li",g)}function U(ak){var al=x();if(al.length==0){return}var O=function(){if(ak){T++}else{T--}};if(g.css("display")=="none"){g.css("display","")}else{O()}if(T>=al.length||T<0){al.removeClass("drop_selected");t.val(b(f));T=ak?-1:al.length;return}var aj=function(){var an=al.length;while(an--){if($(al[an]).attr("id")==("rw"+T.toString())){return $(al[an])}}return $(null)};$(al[T]).mouseout();var ah=aj();if(ah.length<=0){O();ah=aj()}var ai=ab(ah);if(!ai){var ag=""}var am=al.length-1;if(T<0){T=0}if(T>am){T=am}al.removeClass("drop_selected");$(al[T]).mouseover();t.val(b(ai));if(typeof C=="function"){C(ah)}}function ab(ai){if(ai){var ah=ai.find("em");var ag=ah.text();var O=ai.text();if(ag){return O.replace(new RegExp("^w*?"+ag,"g"),"")}else{var aj=ai.find("input[name='inputvalue']");if(aj.length>0){return aj.val()}}return O}return""}function b(O){O=O.replace("<strong>","").replace("</strong>","");O=O.replace(/\<i\>\<\/i\>/ig,"");if(O.indexOf("/")>=0){O=O.substring(0,O.indexOf("/"))}return O}function M(){if(T==-1){return}var O=x();var ag=$(O[T]);t.val(b(ag.text()))}function A(ah){var ai=t.offset();var ag=t.outerWidth();var O=t.outerHeight();g.css("top",ai.top+O);g.css("left",ai.left)}function af(){$("#sugtip_list").width(t.outerWidth()-2)}function F(O){return O.replace(SugExpand.MarkRegex,"")}function I(O){if(typeof O=="string"&&(O.indexOf("$")>=0||O.indexOf("#")>=0)){return true}return false}function aa(O,ag){k(O,ag)}function ad(O){return $(O).find("input[name='inputvalue']").length>0}function k(O,ag){var ah=ab($(O));$("#"+B).val(b(ah));if(ad(O)){X(O)}else{if(B.indexOf("buttom_")<0||B.indexOf("sen_")<0){try{if(typeof W.searchClick=="function"){W.searchClick()}else{$("#btnSearch").click()}}catch(ai){}}}}}function tipClass(a,b){if($("#tipWordList div").length>0){$("#tipWordList div").each(function(){$(this).removeClass(b)})}else{$("#sugtip_list li").each(function(){$(this).removeClass(b)})}$(a).addClass(b)}function tipDivOnMouseOverEvent(g,d,j,b,c){var h=function(){var e=$(g).attr("class");if(e.indexOf("drop_selected")>=0){return true}tipClass(g,"drop_selected");if(d){SugExpand.expendTR(j,b,g,sugPara.Expara||{})}else{$("#expandarea").hide()}};var f=window.event||c;var i=f.fromElement||f.relatedTarget;if(i){if(document.all){if(!(i==g||g.contains(i))){h()}}else{var a=g.compareDocumentPosition(i);if(!(i==g||a==20||a==0)){h()}}}else{h()}}function tipDivOnMouseOutEvent(d,b,a){var c=window.event||a;var g=c.toElement||c.relatedTarget;var i=document.getElementById("expandarea");var f=function(){tipClass(d,"");if(b){$("#expandarea").hide()}return false};var j=function(e){if((e&&e.id=="expandarea")||(i&&i.contains(e))){return true}if(!d.contains(e)){return f()}return true};var h=function(e){var k=function(m,n){if(n&&m){var l=n.compareDocumentPosition(m);if(!(l==20||l==0)){return true}}return false};if(!!(d&&d.nodeName&&d.nodeType==1)&&!!(e&&e.nodeName&&e.nodeType==1)){if(!k(e,i)){return true}if(k(e,d)){return f()}}};if(document.all){return j(g)}else{return h(g)}}var sugUrlComm=(function(){this.URLType={APP:0,SUG:1,EXPAND:2,TOP:3};this.getSugUrl=function(a,e,d,b){var c=b?b:"";return a+"/sug/su.ashx?action=getsmarttips&kw="+encodeURIComponent(d)+"&t="+encodeURIComponent(e)+c+"&p="+Math.random()},this.getAppUrl=function(a,e,d,b){var c=b?b:"";return a+"/Parts/Suggest/GetForJquery?source=kms&item="+encodeURIComponent(e)+"&text="+encodeURIComponent(d)+"&jsonvar=oJson"+c+"&p="+Math.random()};this.gUrlType=function(a,b){if(Object.prototype.toString.call(a)=="[object String]"){var c=/app\.cnki\.net/ig;if(c.test(a)){return URLType.APP}}return URLType.SUG};return{Server:"",getURL:function(a,g,d,b,c){var e=gUrlType(a);if(e==URLType.APP){this.getURL=getAppUrl}else{this.getURL=getSugUrl}return this.getURL(a,g,d,b)},getTopUrl:function(a,c){var b=c?c:"";return a+"/sug/topk.ashx?jsonvar=top_Words_Json"+b+"&v="+((new Date()).getTime())}}})();var SugExpand=(function(){this.getExpandData=function(b,c,a,f){var d=sugUrlComm.getURL(b,c,a,"&jsonvar=eoJson");var e=new CoreDomainLoadJson();e.Load(d,function(){if(typeof f=="function"){f()}},"sugExpandData_JS")};this.creatExpandarea=function(){$("#expandarea").remove();if($("#sugtip_ULlist").length>0){$("#__droplist #sugtip_ULlist").append("<div id='expandarea' name='expandarea' class='dictexpand' ></div>")}else{$("#__droplist").append("<div id='expandarea' name='expandarea' class='dictexpand' ></div>")}};return{MarkRegex:new RegExp("#([\\\d|,]*?)#$","i"),filterMark:function(a){return a.replace(SugExpand.MarkRegex,"")},expendTR:function(i,b,h,c){var e=h;creatExpandarea();var a=false;var f=$("#expandarea");function d(n){f.empty();if(typeof n!="string"){return}var m=g(n);if(m==""){f.hide();a=false;return false}n=n.replace(SugExpand.MarkRegex,"");var l=CircleQueue.prototype.getExData(n);if(l){j(n,m,l);f.show();a=true}else{getExpandData(sugUrlComm.Server,m,n,function(){if(typeof eoJson!="undefined"){CircleQueue.prototype.pushQuery(n,eoJson.sug);j(n,m,eoJson.sug);f.show();a=true}else{f.hide();a=false}})}return a}function g(l){if(SugExpand.MarkRegex.test(l)){return SugExpand.DICTCenter.getDICTKey(RegExp.$1)}return""}function j(m,l,o){if(o){f.empty();var n=new SugExpandTip(SugExpand.filterMark(m),o,l,1,c);f.append(n.getHtml());k();f.mousemove(function(){h.onmouseout=function(){}});f.mouseout(function(){h.onmouseout=e.onmouseout;return false})}}function k(){var m=$("#tipWordList");if(m.length<=0){m=$("#sugtip_ULlist ul").first()}var n=m.height();var l=0;$("#expandarea .dictmore").each(function(){l+=$(this).height()});if(l+20>n){m.height(l+20)}else{$("#expandarea .dictmore").height(n-20)}}d(b)},DICTCenter:(function(){this.DMap={A1:"CJFD_EX",A2:"CCND_EX",A3:"CMFD_EX",A4:"IMAGE_EX",A5:"CSYD_EX",A6:"CDFD_EX",A7:"CYFD_EX",A8:"CRFD_EX"};this.PriorityMap={A1:1,A2:2,A3:3,A4:3,A5:3,A6:6,A7:7,A8:8};this.getPri=function(a){return PriorityMap[a]};this.getDTArray=function(a){var b=a.split(",");for(var c=0;c<b.length;c++){b[c]="A"+b[c]}return b};return{getDICTKey:function(b){var c=getDTArray(b);var a=DMap[c[0]];if(a&&a!=undefined){return a}return""}}})()}})();function SugExpandTip(c,e,d,b,a){if(typeof a!="object"){this.ExpPara={}}else{this.ExpPara=a}this.CurData=e;this.DataType=d;this.CurDataHanlerFun=function(){};this.delGetHtml=function(){return""};this.CurSearchWord=c;this.MixTipCount=b||1;this.LinkArray={};this.PicServerHosts={};this.Init()}SugExpandTip.prototype.getHtml=function(){var a="";if(Object.prototype.toString.call(this.CurData)=="[object Array]"){for(var b=0;b<this.MixTipCount&&b<this.CurData.length;b++){a+=this.delGetHtml(this.CurData[b])}}else{a=this.delGetHtml(this.CurData)}return a};SugExpandTip.prototype.Init=function(){this.LinkArray={CJFD:(this.ExpPara.CJFDLinkS||"")+"/kns/Navi/Bridge.aspx?LinkType=BaseLink&DBCode=cjfd&TableName=cjfdbaseinfo&Field=BaseID&Value={0}",CMFD:(this.ExpPara.CMFDLinkS||"")+"/KNS/Navi/Bridge.aspx?dbcode=CMFD&UnitCode={0}",CDFD:(this.ExpPara.CDFDLinkS||"")+"/KNS/Navi/Bridge.aspx?dbcode=CDFD&UnitCode={0}",CCND:(this.ExpPara.CCNDLinkS||"")+"/KNS/Navi/Bridge.aspx?LinkType=BaseLink&DBCode=ccnd&TableName=ccndbaseinfo&Field=BaseID&Value={0}&JourName={1}&PYKM={0}",CYFD:(this.ExpPara.CYFDLinkS||"")+"/kns/Navi/Bridge.aspx?LinkType=BaseLink&DBCode=cyfd&TableName=njzkjb&Field=BaseID&Value={0}",CRFD:(this.ExpPara.CRFDLinkS||"http://gongjushu.cnki.net")+"/refbook/{0}.html",CSYD:(this.ExpPara.CSYDLinkS||"javascript:void(0);"),IMAGE:(this.ExpPara.IMAGELinkS||"http://image.cnki.net")+"/detail.aspx?ref=kcms&id={0}"};this.PicServerHosts={CJFD:this.ExpPara.CJFDPicS||"",CMFD:this.ExpPara.CMFDPicS||"",CDFD:this.ExpPara.CDFDPicS||"",CCND:this.ExpPara.CCNDPicS||"",CYFD:this.ExpPara.CYFDPicS||"",CRFD:this.ExpPara.CRFDPicS||"http://refbook.img.cnki.net/",CSYD:this.ExpPara.CSYDPicS||"",IMAGE:this.ExpPara.IMAGEPicS||"http://image.cnki.net"};this.HandlerFunMaps(this.DataType);this.CurData=this.CurDataHanlerFun(this.CurData)};SugExpandTip.prototype.HandlerFunMaps=function(a){switch(a){case"CSYD_EX":this.delGetHtml=this.ExpandHtmlMode.gCSYD;this.CurDataHanlerFun=this.InstanceDataHanler.CSYD;break;case"CJFD_EX":this.delGetHtml=this.ExpandHtmlMode.gCJFD;this.CurDataHanlerFun=this.InstanceDataHanler.CJFD;break;case"CCND_EX":this.delGetHtml=this.ExpandHtmlMode.gCCND;this.CurDataHanlerFun=this.InstanceDataHanler.CCND;break;case"CMFD_EX":this.delGetHtml=this.ExpandHtmlMode.gCDMD;this.CurDataHanlerFun=this.InstanceDataHanler.CMFD;break;case"CDFD_EX":this.delGetHtml=this.ExpandHtmlMode.gCDMD;this.CurDataHanlerFun=this.InstanceDataHanler.CDFD;break;case"IMAGE_EX":this.delGetHtml=this.ExpandHtmlMode.gIMAGE;this.CurDataHanlerFun=this.InstanceDataHanler.IMAGE;break;case"CYFD_EX":this.delGetHtml=this.ExpandHtmlMode.gCYFD;this.CurDataHanlerFun=this.InstanceDataHanler.CYFD;break;case"CRFD_EX":this.delGetHtml=this.ExpandHtmlMode.gCRFD;this.CurDataHanlerFun=this.InstanceDataHanler.CRFD;break}return function(b){return null}};SugExpandTip.prototype.getSplitDataArray=function(a){return a.split("$$")};SugExpandTip.prototype.InstanceDataHanler=(function(){this.getHref=function(a,b){if(b&&a){return a.replace(/\{\d\}/ig,b)}return""};this.getPicSRC=function(b,a){return b+a};return{CSYD:function(g){var b=g;var a=b.split("||");if(a&&a.length>0){var e=function(j,h){if(j){var i=j.substring(j.length-1);return h+"/suginfo/CSYD/"+i+"/"+j+".jpg"}return""};var f=new Array();for(var d=0;d<a.length;d++){var c=this.getSplitDataArray(a[d]);if(c.length==2){f.push({PICSRC:e(c[0],this.PicServerHosts.CSYD),HREF:getHref(this.LinkArray.CSYD,c[0]),AT:c[1]})}}return{TN:this.CurSearchWord,TT:"数据",HREF:getHref("http://tongji.cnki.net/kns55/Dig/DigResult.aspx?postZones=xj35%3B&postTar={0}&postYear=ra2000&areaSelType=xjSel&refersource=kdn",encodeURI(this.CurSearchWord)),IARR:f}}},IMAGE:function(f){var b=f;var a=b.split("||");if(a&&a.length>0){var e=new Array();for(var d=0;d<a.length;d++){var c=this.getSplitDataArray(a[d]);if(c.length==2){e.push({PICSRC:getPicSRC(this.PicServerHosts.IMAGE,"/getimage.ashx?id="+c[0]),HREF:getHref(this.LinkArray.IMAGE,c[0]),AT:c[1]})}}return{TN:this.CurSearchWord,TT:"图片",HREF:"/kns/RedirectPage.aspx?action=indexpage&code=IMAGE&korder=1&kw="+encodeURI(this.CurSearchWord),IARR:e}}},CJFD:function(e){var a=e.split("||");var d=new Array();for(var c=0;c<a.length;c++){var b=this.getSplitDataArray(a[c]);d[c]={ID:b[0],TN:b[1],TT:b[2],PicSrc:getPicSRC(this.PicServerHosts.CJFD,"http://c61.cnki.net/CJFD/small/"+b[0]+".jpg"),HREF:getHref(this.LinkArray.CJFD,b[0]),IARR:{ZB:b[3],ZQ:b[4],CBD:b[5],FYZ:b[6],ZYZ:b[7],TZ:[b[8].indexOf("T")>=0?"T":"",b[9]=="1"?"Y":""]}}}return d},CMFD:function(b){var a=this.getSplitDataArray(b);return{ID:a[0],TN:a[1],TT:a[7],PicSrc:getPicSRC(this.PicServerHosts.CMFD,"http://c61.cnki.net/cmfd/"+a[0]+".jpg"),HREF:getHref(this.LinkArray.CMFD,a[0]),IARR:{ZB:a[2],IS211:a[3],LC:a[4],SCF:a[5],SDF:a[6],FW:a[7]}}},CDFD:function(b){var a=this.getSplitDataArray(b);return{ID:a[0],TN:a[1],TT:a[7],PicSrc:getPicSRC(this.PicServerHosts.CDFD,"http://c61.cnki.net/cdfd/"+a[0]+".jpg"),HREF:getHref(this.LinkArray.CDFD,a[0]),IARR:{ZB:a[2],IS211:a[3],LC:a[4],SCF:a[5],SDF:a[6],FW:a[7]}}},CCND:function(b){var a=this.getSplitDataArray(b);return{ID:a[0],TN:a[1],TT:"",PicSrc:getPicSRC(this.PicServerHosts.CCND,"http://c61.cnki.net/ccnd/"+a[0]+".jpg"),HREF:getHref(this.LinkArray.CCND,a[0]),IARR:{ZB:a[2],ZG:a[3],CBD:a[4],ZQ:a[5],CN:a[6]}}},CYFD:function(b){var a=this.getSplitDataArray(b);if(a.length==8){return{ID:a[0],TN:a[1],TT:a[2],PicSrc:getPicSRC(this.PicServerHosts.CYFD,"http://c61.cnki.net/cyfd/"+a[7]+".jpg"),HREF:getHref(this.LinkArray.CYFD,a[0]),IARR:{YE:a[3],ISBN:a[4],ZB:a[5],PT:a[6]}}}return{}},CRFD:function(f){var b=f;var a=b.split("||");if(a&&a.length>0){var e=new Array();for(var d=0;d<a.length;d++){var c=this.getSplitDataArray(a[d]);if(c.length>=8){e.push({ID:c[0],TN:c[1],TT:c[2],PicSrc:getPicSRC(this.PicServerHosts.CRFD,c[7]),HREF:getHref(this.LinkArray.CRFD,c[0]),IARR:{ZR:c[3],ZB:c[4],ISBN:c[5],PT:c[6]}})}}return e}return[]}}})();SugExpandTip.prototype.ExpandHtmlMode=(function(){this.Template={dataImage:{TN:"草原",TT:"图片",IARR:[{PICSRC:"",HREF:"",AT:""},{PICSRC:"",HREF:"",AT:""}]},TITLE:'<h3><a target="_blank" href="<%[HREF]%>" onclick="<%[SCRIPT]%>"><b><%[TN]%></b><%[TT]%></a></h3>',Picture:'<div class="floatL"><img src="<%[PicSrc]%>" class="picbor" /></div>',APicture:'<div class="floatL"><a target="_blank" href="<%[HREF]%>" title="<%[TN]%>"><img src="<%[PicSrc]%>" class="picbor" /></a></div>',SpiteDivHT:'<div class="HT10"></div>',SpiteDivBD:' <div class="BD10"></div>',ShowMore:'<div class="botlink floatR"><%[MORE]%></div>',MoreLink:'<a href="javascript:void(0);">阅读全部<span class="arrow">&gt;&gt;</span></a>',ALink:'<a target="_blank" href="<%[ASRC]%>" title="<%[FTI]%>"><%[FTI]%></a>',LITemplet:"<li><label><%[TITLE]%></label><%[TC]%></li>",IMAGEDETAILLI:' <li><a target="_blank" href="<%[HREF]%>"><img src="<%[PICSRC]%>" /></a><p><a target="_blank" href="<%[HREF]%>" title="<%[AT]%>"><%[AT]%></a></p></li>',IMAGEDETAILLINOLINK:'<li><span><img src="<%[PICSRC]%>" /></span><p><span  title="<%[AT]%>"><%[AT]%></span></p></li>'};this.DataExplain={TN:"刊名|标题|学位授予单位",TT:"类型|英文刊名|学位",PICSRC:"图片地址",YI:"年期（2011年12期）",LC:"文献数",SCF:"总被引",SDF:"总下载",MORE:"更多链接",HREF:"标题链接"};this.gTitle=function(a){return this.Replace(this.Template.TITLE,a)};this.gPic=function(a){return this.Replace(this.Template.Picture,a)};this.gAPic=function(a){return this.Replace(this.Template.APicture,a)};this.gMore=function(a){return this.Replace(this.Template.MoreLink,a)};this.gALink=function(a){return this.Replace(this.Template.ALink,a)};this.gMixUL=function(e,b,c,f){var a="";var d=e.IARR;if(typeof f=="function"){handlFun=f}else{handlFun=function(){return""}}if(d){a='<ul class="infoList floatR">';a+=this.gMixLi(d,this.Template.LITemplet,b,c);a+=handlFun();a+="</ul>"}return a};this.gExMixHtml=function(d,a,b){var c='<div class="dictmore" >';c+=this.gTitle(d);if(b){c+=this.gAPic(d)}if(typeof a=="function"){c+=a();c+='<div class="HT10"></div>'}c+="</div>";return c};this.gMixLi=function(f,b,c,e){var d="";var g=c.length;if(g==e.length){for(var a=0;a<g;a++){var h=f[e[a]];if(h&&h!=undefined){d+=Replace(b,{TITLE:c[a],TC:h})}}}return d};this.gIMAGEMode=function(c,a){var b=a||Template.IMAGEDETAILLI;return gExMixHtml(c,function(){var f=c.IARR;if(f&&f.length>0){var d='<div class="detail"> <ul class="mode5">';var e=f.length;while(e--){d+=Replace(b,f[e])}d+="</ul></div>"}return d},false)};MIX=function(a){return this.Replace(this.Template.MIX,a)};TEXTLIST=function(a){return this.Replace(this.Template.TEXTLIST,a)};IMAGE=function(a){var b=this.H(a);return this.Replace(this.Template.IMAGE,a)};EMPTY=function(a){return""};getV=function(b,a){if(b){for(var c in b){if(c==a){return b[a]}}}return""};Replace=function(a,b){return a.replace(/\<\%\[(.*?)\]\%\>/g,function(c,d){return b[d]})};return{gCJFD:function(a){return gExMixHtml(a,function(){var c=["主办：","周期：","出版地：","复合影响因子：","综合影响因子："];var b=["ZB","ZQ","CBD","FYZ","ZYZ"];return gMixUL(a,c,b,function(){var e="";var d=a.IARR;if(d){var f=d.TZ;if(f&&f.lenth>0){e+="<li>";for(var h=0;h<f.length;h++){switch(f[h]){case"T":e+='<b class="cMarkTip Glod">独家授权</b>';break;case"P":e+='<b class="cMarkTip Silver">优先出版</b>';break}}e+="</li>"}}return e})},true)},gCSYD:function(a){return gIMAGEMode(a,Template.IMAGEDETAILLINOLINK)},gCCND:function(a){return gExMixHtml(a,function(){var c=["主办单位：","主管单位：","出版地：","周期：","国内统一刊号："];var b=["ZB","ZG","CBD","ZQ","CN"];return gMixUL(a,c,b,null)},true)},gCYFD:function(a){return gExMixHtml(a,function(){var c=["年鉴年份：","ISBN：","出版者：","出版日期："];var b=["YE","ISBN","ZB","PT"];return gMixUL(a,c,b,null)},true)},gCRFD:function(a){return gExMixHtml(a,function(){return gMixUL(a,["责任者：","出版者：","ISBN：","出版时间："],["ZR","ZB","ISBN","PT"],null)},true)},gIMAGE:function(a){return gIMAGEMode(a)},gCDMD:function(c){var a='<div class="dictmore" >';a+=gTitle(c);a+=gAPic(c);var e=["省份："];var d=["ZB"];a+=gMixUL(c,e,d,function(){var g="";var f=c.IARR;if(f){var h=f.IS211;if(h&&h=="1"){g+='<li><b class="colorG">211工程院校</b></li>'}}return g});a+='<div class="HT10"></div>';var b=c.IARR;if(b){a+=Replace('<div class="detail"><div class="mode3"><a href="javascript:void(0);">文献数<em><%[LC]%></em></a> <a href="javascript:void(0);">总被引<em><%[SCF]%></em></a><a href="javascript:void(0);">总下载<em><%[SDF]%></em></a></div></div>',b)}a+="</div>";return a}}})();function searchWordEvent(b,a){if(b&&a){$("input[id^=txt_],input[id^=buttom_],input[id^=au_],input[id^=base],input[id^=magazine_],input[id^=sen_]").val(a);if($("#"+b).length>0){$("#"+b).click()}else{}}return false}function CircleQueue(a){CircleQueue.prototype.initQueue(a)}CircleQueue.prototype={initQueue:function(a){this.size=a;this.list=new Array();this.length=0;this.pointer=0},find:function(a,c){var b=this.length;var d=this.defaultFind;if(typeof c=="function"){d=c}while(b--){if(d(this.list[b],a)){return b}}return -1},defaultFind:function(c,d){return c==d},enterQueue:function(a){if(typeof a!="undefined"){if(this.pointer>this.size){this.pointer=0}this.list[this.pointer]=a;this.pointer++;if(this.length<this.size){this.length++}return true}return false},popQueue:function(){if(this.length>0){var a=this.list[this.pointer];this.list--;this.length--;return a}return null},clearQueue:function(){this.length=0;this.pointer=0},isEmpty:function(){if(this.length==0){return true}else{return false}}};CircleQueue.prototype.exfind=function(a){return this.find(a,function(b){return b.key==a})};CircleQueue.prototype.pushQuery=function(b,a){if(b&&a){this.enterQueue({key:b,value:a})}};CircleQueue.prototype.getExData=function(a){var b=this.getEle(a);if(b){return b.value}return""};CircleQueue.prototype.getEle=function(a){var b=this.find(a,function(d,c){if(d){return d.key==c}return false});if(b>=0&&b<this.length){return this.list[b]}return null};